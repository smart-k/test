<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="en">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <newElementTitle>Task 1</newElementTitle>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <style>
        .tasks {
            padding: 20px;
            padding-left: 40px;
        }

        .tasks li {
            position: relative;
        }

        .form-control {
            width: 465px;
            margin-bottom: 15px;
        }

        .button {
            font: 2em Arial, sans-serif;
        }

        .item {
            background-color: #eee;
            border-radius: 5px;
            padding: 4px 10px;
            margin-top: 10px;
        }

        .play {
            width: 100px;
            height: 100px;
            background-color: #369;
            border-radius: 100px;
            position: absolute;
            top: 120px;
            left: 0%;
            margin-left: 0px;
            transition: all 5s;
        }

        .right {
            left: 100%;
            margin-left: -100px;
        }

        #alert_wrapper {
            position: absolute;
            top: 10px;
            right: 20px;
        }

        .alert {
            position: relative;
            width: 450px;
            opacity: 0;
            transition: all 3s
        }

        .alert.show {
            opacity: 1;
        }

        .box {
            height: 400px;
            background-color: #e1e2e3;
            border-color: #000;
            position: relative;
        }

        .dragable {
            position: absolute;
            width: 50px;
            height: 50px;
            cursor: pointer;
            z-index: 1;
        }

        .red {
            background-color: #f00;
        }

        .green {
            background-color: #0b0;
        }

        .blue {
            background-color: #00f;
        }

        .purple {
            background-color: #874de4;
        }

        .move {
            cursor: move;
            opacity: 0.5;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
            z-index: 10;
        }

        .hidden-class {
            display: none;
        }

    </style>

</head>

<body>
    <ol class="tasks">
        <li>
            <h4>
                При нажатии на кнопку, добавлять в <code>div</code> с идентификатором <code>container</code> фрагмент разметки в выбраную позицию. В заголовок писать порядковый номер вставляемого элемента
            </h4>
            <pre>
 &lt;div class="item"&gt; 
 &lt;h4&gt;Заголовок #&lt;/h4&gt;
 &lt;p&gt;текст текст текст&lt;/p&gt;
 &lt;/div&gt;
            </pre>
            <br />
            <div class="item hidden-class" id="my_template">
                <h4>Заголовок #</h4>
                <p>текст текст текст</p>
            </div>
            <select class="form-control" id="selectPlace">
<option value="start">Добавить в начало</option>
<option value="middle">Добавить в середину</option>
<option value="finish">Добавить в конец</option>
            </select>
            <button class="button btn btn-success" id="push">Нажать</button>
            <div id="container"></div>

            <script>
                // script for task #1
                (function() {
                    'use strict';

                    function addMarkup(event) {
                        var container = document.getElementById('container');
                        var newElement = document.getElementById('my_template').cloneNode(true);
                        newElement.getElementsByTagName('h4')[0].innerText += container.children.length + 1;
                        newElement.classList.remove("hidden-class");
                        var selectValue = document.getElementById('selectPlace').value;
                        switch (selectValue) {
                            case "start":
                                container.insertBefore(newElement, container.children[0]);
                                break;
                            case "middle":
                                container.insertBefore(newElement, container.children[parseInt((container.children.length + 1) / 2)]);
                                break;
                            case "finish":
                                container.appendChild(newElement);
                                break;
                        }
                    }
                    document.getElementById("push").addEventListener("click", addMarkup);
                })();

            </script>

        </li>
        <li style="height: 220px">

            <h4>При нажатии на ссылку, равномерно перемещать HTML-элемент с классом <code>play</code> вправо, при повторном нажатии - перемещать влево.</h4>
            <br />


            <a href="/" class="button btn btn-success" id="go">Поехали!</a>
            <div class="play"></div>

            <script>
                // script for task #2
                (function() {
                    'use strict';
                    var playElement = document.querySelector(".play");

                    function moveElement(event) {
                        event.preventDefault();
                        playElement.classList.toggle("moveRight");
                        var direction = playElement.classList.contains("moveRight");
                        switch (direction) {
                            case true:
                                playElement.classList.add("right");
                                break;
                            case false:
                                playElement.classList.remove("right");
                                break;
                        }
                    }
                    var button = document.getElementById('go');
                    button.addEventListener("click", moveElement);
                })();

            </script>

        </li>
        <li>
            <h4>При нажатии на кнопку выдавать bootstrap-alert соответствующего типа c текстом из поля ввода. HTML код всплывающих элементов можно посмотреть по <a href="https://www.w3schools.com/bootstrap/bootstrap_alerts.asp">ссылке</a>. Alert должен плавно появляться в верхнем правом углу, при нажатии на крестик - исчезать. Так же alert'ы должны закрываться автоматичесски через 10 секунд. Если несколько раз подряд нажать на кнопку - то сообщения выстраиваются один под другим.
            </h4>
            <br />


            <input type="text" class="form-control">

            <button class="button btn btn-success" id="button_alert_Success">Success</button>
            <button class="button btn btn-info" id="button_alert_Info">Info</button>
            <button class="button btn btn-warning" id="button_alert_Warning">Warning</button>
            <button class="button btn btn-danger" id="button_alert_Danger">Danger</button>


            <script>
                // script for task #3

                // Map: buttonId => alertId
                var alertsMap = {
                    "button_alert_Success": "Success",
                    "button_alert_Info": "Info",
                    "button_alert_Warning": "Warning",
                    "button_alert_Danger": "Danger"
                };
                // timeoutId for one click & double mouse click detection
                var timeoutId;
                const clickDelay = 500;
                // Store timerId's as key => value
                var timers = {};
                var wrapper;
                /*
                Close alert if x clicked
                */
                function closeAlert(event) {
                    event.preventDefault();
                    // Get alert 
                    var el = event.currentTarget.parentNode;
                    var id = el.getAttribute("id");
                    // Clear active timer for this alert 
                    clearTimeout(timers[id]);
                    delete timers[id];
                    // Remove alert from the wrapper 
                    wrapper = el.parentNode;
                    wrapper.removeChild(el);
                }

                document.addEventListener("DOMContentLoaded", function(event) {
                    'use strict';
                    event.preventDefault();
                    // Timer delay
                    const delay = 10000;
                    /*    
                    Show alert to the user
                    */
                    function showAlert(alertId) {
                        var elem = document.getElementById(alertId);
                        // Make alert
                        var alert = elem.cloneNode(true);
                        var newAlertId = alert.getAttribute("id") + "-" + Math.ceil(Math.random() * 100);
                        alert.setAttribute("id", newAlertId);
                        // Add user input to the alert
                        var input = document.getElementsByTagName('input');
                        alert.lastChild.nodeValue = " " + input[0].value;
                        // Add alert to wrapper
                        wrapper = document.getElementById('alert_wrapper');
                        wrapper.appendChild(alert);
                        // Show alert
                        alert.classList.add("show");
                        // Set alert's timer
                        timers[newAlertId] = setTimeout(() => {
                            wrapper.removeChild(alert);
                        }, delay);
                    }
                    /*    
                    Button's click handler
                    */
                    function showOneClickAlert(e) {
                        // If one button's click
                        if (!timeoutId)
                            timeoutId = setTimeout((e) => {
                                clearTimeout(timeoutId);
                                timeoutId = null;

                                var wrapper = document.getElementById('alert_wrapper');
                                // Remove all active alerts from the wrapper
                                for (var i = 0; i < wrapper.childNodes.length; i++) {
                                    wrapper.removeChild(wrapper.childNodes[i]);
                                }
                                // Clear all timers
                                for (var id in timers) {
                                    clearTimeout(timers[id]);
                                    delete timers[id];
                                }
                                // Get button's Id
                                var buttonId = this.getAttribute("id");
                                // Get alertId from alertsMap
                                var alertId = alertsMap[buttonId];
                                showAlert(alertId);
                            }, clickDelay);
                    }
                    /*
                    Button's double click handler
                    */
                    function showDblClickAlert(e) {
                        clearTimeout(timeoutId);
                        timeoutId = null;
                        // Get button's Id
                        var buttonId = this.getAttribute("id");
                        // Get alertId from alertsMap
                        var alertId = alertsMap[buttonId];
                        showAlert(alertId);
                    }
                    // Set events handlers
                    var buttons = [];
                    buttons.push(document.getElementById('button_alert_Success'));
                    buttons.push(document.getElementById('button_alert_Info'));
                    buttons.push(document.getElementById('button_alert_Warning'));
                    buttons.push(document.getElementById('button_alert_Danger'));
                    buttons.forEach((item) => {
                        item.addEventListener("click", showOneClickAlert);
                        item.addEventListener("dblclick", showDblClickAlert);
                    });
                    document.querySelectorAll('a.close').forEach((item) => {
                        item.setAttribute("onclick", "closeAlert(event)");
                    });
                });

            </script>
        </li>
        <li>
            <h4><b class="h2 text-danger">*</b> Сделать кнопочку <i class="text-info">scroll to top</i>, она должна появляться когда пользователь проскролил страницу на размер одного видимого экрана. Кнопочку нужно аккуратно стилизовать.
            </h4>
            <br />

            <button class="button btn btn-info" id="scroll">scroll to top</button>

            <script>
                // script for task #4
                (function() {
                    'use strict';
                    var scrollButton = document.getElementById('scroll');

                    scrollButton.onclick = () => {
                        document.documentElement.scrollTop = 0;
                    };

                    document.onscroll = () => {
                        window.pageYOffset > document.documentElement.clientHeight * 0.87 ? scrollButton.classList.remove("hidden-class") : scrollButton.classList.add("hidden-class");
                    };
                })();

            </script>
        </li>
        <li>
            <h4><b class="h2 text-danger">**</b> Реализовать перемещение элементов внутри контейнера. Элементы нельзя ставить ближе <i class="text-info">10px</i> к границе контейнера. Во время перемещения элемента ему должен присваиваться класс <code>move</code>. Перетаскивание эелементов должно так де работать и на мобильных устройствах.</h4>
            <br />

            <div class="panel box">
                <div class="dragable red" style="left: 250px;top: 28px;"></div>
                <div class="dragable green" style="left: 50px;top: 68px;"></div>
                <div class="dragable blue" style="left: 350px;top: 287px;"></div>
                <div class="dragable purple move" style="left: 70px;top: 28px;"></div>
            </div>

            <script>
                // script for task #5
                (function() {
                    'use strict';
                    var items = document.querySelectorAll('div.dragable');
                    var panel = document.querySelector('div.panel.box');
                    var shiftX, shiftY;

                    // Set events handlers
                    items.forEach((item) => {
                        item.onmousedown = actionOnMouseDown;
                        item.touchstart = actionOnMouseDown;
                        item.ondragstart = function() {
                            return false;
                        };
                    });

                    function actionOnMouseUp(e) {
                        var item = this;
                        item.classList.remove("move");
                        document.onmousemove = null;
                        document.touchmove = null;
                        item.onmouseup = null;
                        item.touchend = null;
                    }

                    function actionOnMouseDown(e) {
                        var item = this;
                        var rightMargin = 10 + item.clientWidth;
                        var bottomMargin = 10 + item.clientHeight;
                        var coords = getCoords(item);

                        shiftX = e.pageX - coords.left;
                        shiftY = e.pageY - coords.top;

                        item.classList.add("move");
                        document.body.appendChild(item);
                        moveAt(e);

                        function moveAt(e) {
                            var panelCoords = getCoords(panel);

                            var left = e.pageX - shiftX;
                            var top = e.pageY - shiftY;

                            if (left - panelCoords.left > 10 && panelCoords.right - left > rightMargin) item.style.left = left + 'px';
                            if (top - panelCoords.top > 10 && panelCoords.bottom - top > bottomMargin) item.style.top = e.pageY - shiftY + 'px';
                        }

                        function actionOnMouseMove(e) {
                            moveAt(e);
                        }

                        document.onmousemove = actionOnMouseMove;
                        document.touchmove = actionOnMouseMove;
                        this.onmouseup = actionOnMouseUp;
                        this.touchend = actionOnMouseUp;
                    }

                    function getCoords(elem) {
                        var box = elem.getBoundingClientRect();
                        return {
                            top: box.top + pageYOffset,
                            bottom: box.bottom + pageYOffset,
                            left: box.left + pageXOffset,
                            right: box.right + pageXOffset
                        };
                    }
                })();

            </script>
        </li>
    </ol>
    <br><br><br>

    <div id="alert_wrapper">
    </div>

    <div class="alert alert-success" id="Success">
        <a href="#" class="close" newElementTitle="close">&times;</a>
        <strong>Success!</strong> Indicates a successful or positive action.
    </div>

    <div class="alert alert-info" id="Info">
        <a href="#" class="close" newElementTitle="close">&times;</a>
        <strong>Info!</strong> Indicates a neutral informative change or action. With long long text
    </div>

    <div class="alert alert-warning" id="Warning">
        <a href="#" class="close" newElementTitle="close">&times;</a>
        <strong>Warning!</strong> Indicates a warning that might need attention.
    </div>

    <div class="alert alert-danger" id="Danger">
        <a href="#" class="close" newElementTitle="close">&times;</a>
        <strong>Danger!</strong> Indicates a dangerous or potentially negative action.
    </div>
    <!--
    <div class="alert alert-success" style="top: 10px" id="Success">
        <a href="#" class="close" newElementTitle="close">&times;</a>
        <strong>Success!</strong> Indicates a successful or positive action.
    </div>s

    <div class="alert alert-info" style="top: 70px" id="Info">
        <a href="#" class="close" newElementTitle="close">&times;</a>
        <strong>Info!</strong> Indicates a neutral informative change or action. With long long text
    </div>

    <div class="alert alert-warning" style="top: 150px" id="Warning">
        <a href="#" class="close" newElementTitle="close">&times;</a>
        <strong>Warning!</strong> Indicates a warning that might need attention.
    </div>

    <div class="alert alert-danger" style="top: 210px" id="Danger">
        <a href="#" class="close" newElementTitle="close">&times;</a>
        <strong>Danger!</strong> Indicates a dangerous or potentially negative action.
    </div>
-->
</body>

</html>
